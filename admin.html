<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Master | Talisson Motors</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background: #121212; color: #fff; margin: 0; padding: 20px; display: flex; justify-content: center; }
        
        /* LOGIN */
        #login-box { text-align: center; background: #1e1e1e; padding: 40px; border-radius: 10px; border: 1px solid #333; margin-top: 100px; width: 300px; }
        input, select, textarea { background: #333; border: 1px solid #444; color: white; padding: 12px; width: 100%; border-radius: 5px; margin: 5px 0 15px 0; box-sizing: border-box; font-family: inherit; }
        
        /* PAINEL */
        #painel { display: none; width: 100%; max-width: 1100px; }
        
        .grid-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        
        .card-admin { background: #1e1e1e; padding: 25px; border-radius: 10px; border: 1px solid #333; border-top: 3px solid #d4af37; margin-bottom: 20px; }
        
        h2 { color: #d4af37; margin-top: 0; font-size: 1.2rem; border-bottom: 1px solid #333; padding-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        label { font-size: 0.8rem; color: #aaa; font-weight: bold; display: block; margin-top: 10px; }

        .btn { padding: 12px; font-weight: bold; cursor: pointer; border-radius: 5px; width: 100%; border: none; transition: 0.3s; }
        .btn-gold { background: #d4af37; color: #000; }
        .btn-gold:hover { background: #fff; }
        .btn-blue { background: #007bff; color: #fff; }
        .btn-blue:hover { background: #0056b3; }
        .btn-red { background: #b00020; color: #fff; width: auto; padding: 8px 20px; }

        .check-oferta { background: #2a2a2a; padding: 10px; border-radius: 5px; display: flex; align-items: center; gap: 10px; cursor: pointer; border: 1px solid #444; margin-top: 10px; }
        .check-oferta input { width: 20px; margin: 0; }

        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full { grid-column: 1 / -1; }

        .item-lista { display: flex; justify-content: space-between; align-items: center; background: #222; padding: 10px; margin-bottom: 5px; border-radius: 4px; border-left: 3px solid #d4af37; }
        .thumb { width:60px; height:40px; object-fit:cover; border-radius:3px; margin-right:10px; }

        /* CARD ESPECIAL PARA LEADS (PEDIDOS) */
        .lead-item { background: #1a252f; border-left: 4px solid #007bff; padding: 15px; margin-bottom: 10px; border-radius: 4px; }
        
        @media (max-width: 768px) { .grid-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div id="login-box">
        <h2 style="justify-content:center; color:#d4af37">√ÅREA RESTRITA</h2>
        <input type="password" id="pass" placeholder="Senha">
        <button class="btn btn-gold" onclick="logar()">Acessar Painel</button>
    </div>

    <div id="painel">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h1 style="margin:0">Painel Master</h1>
            <button class="btn btn-red" onclick="location.reload()">Sair</button>
        </div>

        <div class="grid-layout">
            
            <div>
                <div class="card-admin" style="border-top-color: #007bff;">
                    <h2 style="color:#007bff">üìÑ Pedidos de Financiamento</h2>
                    <div id="lista-leads"></div>
                </div>

                <div class="card-admin">
                    <h2>üì¢ Banners Promocionais</h2>
                    <label>Subir Imagem:</label>
                    <input type="file" id="banner-upload" accept="image/*">
                    <button class="btn btn-blue" onclick="salvarBannerPromo()">+ Adicionar Banner</button>
                    <div id="lista-banners" style="margin-top:20px;"></div>
                </div>

                <div class="card-admin">
                    <h2>üõ†Ô∏è Configura√ß√µes</h2>
                    <label>WhatsApp:</label>
                    <input type="text" id="cfg-zap" placeholder="Ex: 5512999999999">
                    <label>Texto 'Sobre N√≥s':</label>
                    <textarea id="cfg-sobre" rows="4"></textarea>
                    <button class="btn btn-blue" onclick="salvarConfig()">üíæ Salvar Config</button>
                </div>
            </div>

            <div class="card-admin">
                <h2>üöò Cadastrar Ve√≠culo</h2>
                <div class="form-grid">
                    <div class="full">
                        <label>Fotos (V√°rias):</label>
                        <input type="file" id="fotos" multiple accept="image/*">
                    </div>

                    <div class="full check-oferta" style="flex-direction: column; align-items: flex-start;">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <input type="checkbox" id="oferta">
                            <label for="oferta" style="color:#fff; cursor:pointer; margin:0;">üî• Destacar no Banner?</label>
                        </div>
                        <input type="text" id="frase-destaque" placeholder="Frase de Impacto (Ex: IPVA GR√ÅTIS)" style="margin-top:10px; display:none;">
                    </div>

                    <div><label>Modelo:</label><input type="text" id="modelo" style="text-transform: uppercase;"></div>
                    <div><label>Vers√£o:</label><input type="text" id="versao"></div>
                    <div><label>Pre√ßo (R$):</label><input type="text" id="preco"></div>
                    <div><label>Ano:</label><input type="text" id="ano"></div>
                    <div><label>KM:</label><input type="text" id="km"></div>
                    <div><label>Cidade:</label><input type="text" id="cidade" value="S√£o Jos√© dos Campos - SP"></div>

                    <div class="full">
                        <button class="btn btn-gold" onclick="salvarCarro()">+ Cadastrar</button>
                    </div>
                </div>
            </div>

        </div>

        <div class="card-admin">
            <h2>üì¶ Estoque Atual</h2>
            <div id="lista"></div>
        </div>
    </div>

    <script>
        // Checkbox l√≥gica
        document.getElementById('oferta').addEventListener('change', function() {
            document.getElementById('frase-destaque').style.display = this.checked ? 'block' : 'none';
        });

        function logar() {
            if(document.getElementById('pass').value === 'admin') {
                document.getElementById('login-box').style.display = 'none';
                document.getElementById('painel').style.display = 'block';
                carregarTudo();
            } else { alert('Senha Incorreta!'); }
        }

        // --- BANNERS ---
        function salvarBannerPromo() {
            const file = document.getElementById('banner-upload').files[0];
            if(!file) return alert('Selecione uma imagem!');
            const reader = new FileReader();
            reader.onload = function(e) {
                const banners = JSON.parse(localStorage.getItem('talisson_banners')) || [];
                banners.push({ id: Date.now(), imagem: e.target.result });
                localStorage.setItem('talisson_banners', JSON.stringify(banners));
                alert('Banner Adicionado!');
                carregarTudo();
            };
            reader.readAsDataURL(file);
        }
        function deletarBanner(id) {
            if(confirm('Apagar banner?')) {
                let banners = JSON.parse(localStorage.getItem('talisson_banners')) || [];
                banners = banners.filter(b => b.id !== id);
                localStorage.setItem('talisson_banners', JSON.stringify(banners));
                carregarTudo();
            }
        }

        // --- CARROS ---
        function salvarCarro() {
            const inputs = ['modelo', 'versao', 'preco', 'ano', 'km', 'cidade'];
            let valido = true;
            inputs.forEach(id => { if(!document.getElementById(id).value) valido = false; });
            
            const fotosInp = document.getElementById('fotos');
            if(fotosInp.files.length === 0 || !valido) return alert('Preencha tudo!');

            const promises = Array.from(fotosInp.files).map(f => new Promise(r => {
                const reader = new FileReader();
                reader.onload = e => r(e.target.result);
                reader.readAsDataURL(f);
            }));

            Promise.all(promises).then(fotos => {
                const carro = {
                    id: Date.now(), fotos: fotos,
                    modelo: document.getElementById('modelo').value,
                    versao: document.getElementById('versao').value,
                    preco: document.getElementById('preco').value,
                    ano: document.getElementById('ano').value,
                    km: document.getElementById('km').value,
                    cidade: document.getElementById('cidade').value,
                    oferta: document.getElementById('oferta').checked,
                    fraseDestaque: document.getElementById('frase-destaque').value
                };
                const db = JSON.parse(localStorage.getItem('talisson_final_db')) || [];
                db.push(carro);
                localStorage.setItem('talisson_final_db', JSON.stringify(db));
                alert('Salvo!');
                carregarTudo();
                document.querySelectorAll('input').forEach(i => i.value='');
            });
        }
        function deletarCarro(id) {
            if(confirm('Apagar?')) {
                let db = JSON.parse(localStorage.getItem('talisson_final_db')) || [];
                db = db.filter(c => c.id !== id);
                localStorage.setItem('talisson_final_db', JSON.stringify(db));
                carregarTudo();
            }
        }

        // --- CONFIG ---
        function salvarConfig() {
            const config = { zap: document.getElementById('cfg-zap').value, sobre: document.getElementById('cfg-sobre').value };
            localStorage.setItem('talisson_config', JSON.stringify(config));
            alert('Config Salva!');
        }

        // --- LEADS (ESSA √â A PARTE NOVA QUE FALTAVA) ---
        function apagarLead(id) {
            if(confirm('Arquivar este pedido?')) {
                let leads = JSON.parse(localStorage.getItem('talisson_leads')) || [];
                leads = leads.filter(l => l.id !== id);
                localStorage.setItem('talisson_leads', JSON.stringify(leads));
                carregarTudo();
            }
        }

        // --- CARREGAR TUDO ---
        function carregarTudo() {
            // 1. LEADS
            const leads = JSON.parse(localStorage.getItem('talisson_leads')) || [];
            const listaL = document.getElementById('lista-leads');
            listaL.innerHTML = '';
            if(leads.length === 0) listaL.innerHTML = '<p style="color:#666">Nenhuma proposta ainda.</p>';
            
            leads.forEach(l => {
                const msgZap = `Ol√° ${l.nome}, recebemos sua proposta para o *${l.carro}* (Entrada: R$${l.entrada}). Vamos conversar?`;
                const link = `https://wa.me/55${l.zap}?text=${encodeURIComponent(msgZap)}`;

                listaL.innerHTML += `
                    <div class="lead-item">
                        <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                            <strong style="color:#007bff; font-size:1.1rem;">${l.nome}</strong>
                            <small style="color:#aaa">${l.data}</small>
                        </div>
                        <div style="color:#ddd; font-size:0.9rem; line-height:1.5;">
                            üöó <b>${l.carro}</b><br>
                            üí∞ Entrada: R$ ${l.entrada} | ${l.parcelas}<br>
                            üìÑ CPF: ${l.cpf}<br>
                            üì± Tel: ${l.zap}
                        </div>
                        <div style="margin-top:10px; display:flex; gap:10px;">
                            <a href="${link}" target="_blank" class="btn btn-blue" style="text-decoration:none; text-align:center; font-size:0.8rem; padding:8px;">Chamar no Zap</a>
                            <button class="btn btn-red" onclick="apagarLead(${l.id})" style="font-size:0.8rem; width:auto;">Arquivar</button>
                        </div>
                    </div>`;
            });

            // 2. CARROS
            const db = JSON.parse(localStorage.getItem('talisson_final_db')) || [];
            const lista = document.getElementById('lista');
            lista.innerHTML = '';
            db.forEach(c => {
                lista.innerHTML += `
                    <div class="item-lista">
                        <div style="display:flex; align-items:center;">
                            <img src="${c.fotos[0]}" class="thumb">
                            <div><strong>${c.modelo}</strong> <br> <small>${c.oferta ? 'üî• ' + c.fraseDestaque : ''}</small></div>
                        </div>
                        <button class="btn btn-red" onclick="deletarCarro(${c.id})">Apagar</button>
                    </div>`;
            });

            // 3. BANNERS
            const banners = JSON.parse(localStorage.getItem('talisson_banners')) || [];
            const listaB = document.getElementById('lista-banners');
            listaB.innerHTML = '';
            banners.forEach(b => {
                listaB.innerHTML += `
                    <div class="item-lista">
                        <img src="${b.imagem}" class="thumb" style="width:100px;">
                        <button class="btn btn-red" onclick="deletarBanner(${b.id})">X</button>
                    </div>`;
            });

            // 4. CONFIG
            const config = JSON.parse(localStorage.getItem('talisson_config')) || {};
            if(config.zap) document.getElementById('cfg-zap').value = config.zap;
            if(config.sobre) document.getElementById('cfg-sobre').value = config.sobre;
        }

        carregarTudo();
    </script>
</body>
</html>